@baseUrl = http://localhost:3000
@tenant_token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5OGRjOTNhYmJmMmM2YWI2ODFiYzBjZSIsInJvbGUiOjAsImlhdCI6MTc3MDk4MDc2MywiZXhwIjoxNzcxNTg1NTYzfQ.W-k_X0sbUVPe8Tbhtq4WUNOqTznCbgVvWQVGeRl6jWo
@owner_token = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY5OGRhNjFmNDBlNDJlMWRiOWJhN2EyZCIsInJvbGUiOjEsImlhdCI6MTc3MTg1NDA5OCwiZXhwIjoxNzcyNDU4ODk4fQ.81cxa0IYFozBnHcF5W6xzzUFpfeH8xbyFwP8vXsjP_E

#######################################
### 2Ô∏è‚É£ LOGIN TENANT
#######################################

### Login tenant
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "chu-nha-01@gmail.com",
  "password": "0987654321"
}

### Logout
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{tenant_token}}


#######################################
### 3Ô∏è‚É£ LOGIN OWNER (ƒê√É SET ROLE TRONG DB)
#######################################

### Login owner
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "email": "admin@gmail.com",
  "password": "123456"
}

### Logout
POST {{baseUrl}}/api/auth/logout
Authorization: Bearer {{owner_token}}

#######################################
### 7Ô∏è‚É£ TEST GET USER BY ID
#######################################

### Owner get other user (SUCCESS)
GET {{baseUrl}}/api/users/6981a0b50a0f1d184ed05413
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response c√≥ th√¥ng tin user
###

### Tenant get their own user (SUCCESS)
GET {{baseUrl}}/api/users/698dc93abb72c6ab681bc0ce
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 200 OK
# Tenant c√≥ th·ªÉ xem user c·ªßa h·ªç
###

### Tenant get other user (FORBIDDEN)
GET {{baseUrl}}/api/users/6981a0b50a0f1d184ed05413
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
# Response: {"message": "You can only view your own profile"}
###

### Get non-existent user (NOT FOUND)
GET {{baseUrl}}/api/users/507f1f77bcf86cd799439011
Authorization: Bearer {{owner_token}}

###
# EXPECT: 404 Not Found
# Response: {"message": "User not found"}
###

### Get user without auth (UNAUTHORIZED)
GET {{baseUrl}}/api/users/6981a0b50a0f1d184ed05413

###
# EXPECT: 401 Unauthorized
###

#######################################

### Get all users (SUCCESS - OWNER)
GET {{baseUrl}}/api/users
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ danh s√°ch t·∫•t c·∫£ users (kh√¥ng c√≥ password)
###

### Search users by email
GET {{baseUrl}}/api/users?email=admin
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ users c√≥ email ch·ª©a "admin" (case insensitive)
###

### Search users by name
GET {{baseUrl}}/api/users?name=nguyen
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ users c√≥ t√™n ch·ª©a "nguyen" (case insensitive)
###

### Search users by phone
GET {{baseUrl}}/api/users?phone=0123
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ users c√≥ s·ªë ƒëi·ªán tho·∫°i ch·ª©a "0123"
###

### Search users by multiple params (email + name)
GET {{baseUrl}}/api/users?email=gmail&name=van
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ users th·ªèa m√£n c·∫£ email ch·ª©a "gmail" V√Ä t√™n ch·ª©a "van"
###

### Get users with pagination (page 1, default limit 10)
GET {{baseUrl}}/api/users?page=1
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 10 users v√† pagination info
###

### Get users with custom limit (page 1, limit 5)
GET {{baseUrl}}/api/users?page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 users v√† pagination info
###

### Get users with search and pagination
GET {{baseUrl}}/api/users?email=gmail&page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 users c√≥ email ch·ª©a "gmail" v√† pagination info
###

### Get all users (TENANT - FORBIDDEN)
GET {{baseUrl}}/api/users
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
###

### Get all users (WITHOUT AUTH - FAIL)
GET {{baseUrl}}/api/users

###
# EXPECT: 401 Unauthorized
###

#######################################
### 9Ô∏è‚É£ TEST BUILDING API
#######################################

### Create building (SUCCESS - OWNER)
POST {{baseUrl}}/api/buildings
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "name": "To√† nh√† Green Park",
  "address": "789 L√™ VƒÉn Vi·ªát",
  "district": "Qu·∫≠n 9",
  "city": "TP.HCM",
  "totalFloors": 5,
  "totalRooms": 20,
  "yearBuilt": 2019,
  "description": "To√† nh√† ph√π h·ª£p cho sinh vi√™n v√† nh√¢n vi√™n vƒÉn ph√≤ng",
  "utilities": ["Parking", "WiFi", "Laundry Room"]
}

###
# EXPECT: 201 Created
# Response s·∫Ω c√≥ building data v·ªõi ownerId = current user id
###

### Get building by ID (SUCCESS - OWNER)
GET {{baseUrl}}/api/buildings/698ed98d24f5a32a41e3fde4
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ building data
###

### Get all buildings (SUCCESS - OWNER)
GET {{baseUrl}}/api/buildings
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ t·∫•t c·∫£ buildings v√† pagination info
###

### Search buildings by name
GET {{baseUrl}}/api/buildings?name=chung
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ buildings c√≥ t√™n ch·ª©a "chung" (case insensitive)
###

### Search buildings by address
GET {{baseUrl}}/api/buildings?address=abc
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ buildings c√≥ ƒë·ªãa ch·ªâ ch·ª©a "abc" (case insensitive)
###

### Search buildings by district
GET {{baseUrl}}/api/buildings?district=quan
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ buildings c√≥ qu·∫≠n ch·ª©a "quan" (case insensitive)
###

### Search buildings by city
GET {{baseUrl}}/api/buildings?city=hcm
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ buildings c√≥ th√†nh ph·ªë ch·ª©a "hcm" (case insensitive)
###

### Get buildings with pagination (page 1, default limit 10)
GET {{baseUrl}}/api/buildings?page=1
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 10 buildings v√† pagination info
###

### Get buildings with custom limit (page 1, limit 5)
GET {{baseUrl}}/api/buildings?page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 buildings v√† pagination info
###

### Get buildings with search and pagination
GET {{baseUrl}}/api/buildings?name=chung&page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 buildings c√≥ t√™n ch·ª©a "chung" v√† pagination info
###

### Update building (SUCCESS - OWNER)
PUT {{baseUrl}}/api/buildings/698ed98d24f5a32a41e3fde4
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "name": "Chung c∆∞ ABC Updated",
  "description": "Chung c∆∞ cao c·∫•p - ƒë√£ c·∫≠p nh·∫≠t"
}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ building data ƒë√£ c·∫≠p nh·∫≠t
###

### Delete building (SUCCESS - OWNER)
DELETE {{baseUrl}}/api/buildings/698ed98d24f5a32a41e3fde4
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ building data ƒë√£ x√≥a
###

### Create building (TENANT - FORBIDDEN)
POST {{baseUrl}}/api/buildings
Authorization: Bearer {{tenant_token}}
Content-Type: application/json

{
  "name": "Building by Tenant",
  "address": "456 ƒê∆∞·ªùng XYZ",
  "district": "Qu·∫≠n 2",
  "city": "TP.HCM",
  "totalFloors": 5,
  "totalRooms": 20,
  "yearBuilt": 2022
}

###
# EXPECT: 403 Forbidden
###

### Get building by ID (TENANT - FORBIDDEN)
GET {{baseUrl}}/api/buildings/698ed98d24f5a32a41e3fde4
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
# TENANT kh√¥ng th·ªÉ xem building details
###

#######################################
### 11Ô∏è‚É£ TEST ROOM API
#######################################

### Create room (SUCCESS - OWNER)
POST {{baseUrl}}/api/rooms
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "number": "101",
  "buildingId": "698ed98d24f5a32a41e3fde4",
  "floor": 1,
  "area": 50,
  "price": 5000000,
  "description": "Ph√≤ng 101"
}

###
# EXPECT: 201 Created
# Response s·∫Ω c√≥ room data
###

### Get all rooms (SUCCESS - OWNER)
GET {{baseUrl}}/api/rooms
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ danh s√°ch rooms v√† pagination info
###

### Get all rooms (TENANT - FORBIDDEN)
GET {{baseUrl}}/api/rooms
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
# Ch·ªâ ch·ªß m·ªõi c√≥ th·ªÉ xem danh s√°ch ph√≤ng
###

### Search rooms by number
GET {{baseUrl}}/api/rooms?number=101
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ rooms c√≥ s·ªë ph√≤ng ch·ª©a "101" (case insensitive)
###

### Search rooms by building ID
GET {{baseUrl}}/api/rooms?buildingId=698ed98d24f5a32a41e3fde4
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ rooms thu·ªôc t√≤a nh√† c√≥ ID n√†y
###

### Search rooms by floor
GET {{baseUrl}}/api/rooms?floor=1
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ rooms ·ªü t·∫ßng 1
###

### Search rooms by status
GET {{baseUrl}}/api/rooms?status=available
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ rooms c√≥ tr·∫°ng th√°i "available"
###

### Get rooms with pagination (page 1, default limit)
GET {{baseUrl}}/api/rooms?page=1
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 10 rooms v√† pagination info
###

### Get rooms with custom limit (page 1, limit 5)
GET {{baseUrl}}/api/rooms?page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 rooms v√† pagination info
###

### Get rooms without auth
GET {{baseUrl}}/api/rooms

###
# EXPECT: 401 Unauthorized
###

### Update room (SUCCESS - OWNER)
PUT {{baseUrl}}/api/rooms/{room_id}
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "price": 6000000,
  "description": "Ph√≤ng 101 - c·∫≠p nh·∫≠t"
}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ room data ƒë√£ c·∫≠p nh·∫≠t
# Note: Replace {room_id} with the ID from a room in the building
###

### Update room (TENANT - FORBIDDEN)
PUT {{baseUrl}}/api/rooms/{room_id}
Authorization: Bearer {{tenant_token}}
Content-Type: application/json

{
  "price": 7000000
}

###
# EXPECT: 403 Forbidden
###

### Update room (NOT FOUND)
PUT {{baseUrl}}/api/rooms/507f1f77bcf86cd799439011
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "price": 8000000
}

###
# EXPECT: 404 Not Found
###

### Assign tenant (SUCCESS - OWNER)
POST {{baseUrl}}/api/rooms/69981d9e46c8af57f060929c/assign-tenant
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "userId": "698dc9dfeab8faf032a3314f"
}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ room data v·ªõi currentTenant v√† status OCCUPIED
# Tenant record s·∫Ω ƒë∆∞·ª£c t·∫°o v·ªõi moveInDate = ng√†y hi·ªán t·∫°i, contractEndDate = null, emergencyContact = ""
###

### Assign tenant (TENANT - FORBIDDEN)
POST {{baseUrl}}/api/rooms/{room_id}/assign-tenant
Authorization: Bearer {{tenant_token}}
Content-Type: application/json

{
  "userId": "698dc93abb72c6ab681bc0ce"
}

###
# EXPECT: 403 Forbidden
###

### Assign tenant (NOT FOUND)
POST {{baseUrl}}/api/rooms/507f1f77bcf86cd799439011/assign-tenant
Authorization: Bearer {{owner_token}}
Content-Type: application/json

{
  "userId": "698dc93abb72c6ab681bc0ce"
}

###
# EXPECT: 404 Not Found
###

### Delete room (TENANT - FORBIDDEN)
DELETE {{baseUrl}}/api/rooms/{room_id}
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
###

### Delete room (NOT FOUND)
DELETE {{baseUrl}}/api/rooms/507f1f77bcf86cd799439011
Authorization: Bearer {{owner_token}}

###
# EXPECT: 404 Not Found
###

### Delete room (SUCCESS - OWNER)
DELETE {{baseUrl}}/api/rooms/{room_id}
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ room data ƒë√£ x√≥a
###

#######################################
### üîü TEST GET ALL TENANTS API
#######################################

### Get all tenants (SUCCESS - OWNER)
GET {{baseUrl}}/api/tenants
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ danh s√°ch t·∫•t c·∫£ tenants v·ªõi user v√† room info
###

### Get active tenants only (SUCCESS - OWNER)
GET {{baseUrl}}/api/tenants?status=active
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ danh s√°ch tenants ƒëang ·ªü (status = ACTIVE)
###

### Get inactive tenants only (SUCCESS - OWNER)
GET {{baseUrl}}/api/tenants?status=inactive
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ danh s√°ch tenants ƒë√£ tr·∫£ ph√≤ng (status = INACTIVE)
###

### Filter tenants by userId (SUCCESS - OWNER)
GET {{baseUrl}}/api/tenants?userId=698dc93abb72c6ab681bc0ce
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ tenant records c·ªßa user c·ª• th·ªÉ
###

### Filter tenants by roomId (SUCCESS - OWNER)
GET {{baseUrl}}/api/tenants?roomId=69981d9e46c8af57f060929c
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ tenant records c·ªßa ph√≤ng c·ª• th·ªÉ
###

### Get tenants with pagination (page 1, limit 5)
GET {{baseUrl}}/api/tenants?page=1&limit=5
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 5 tenants v√† pagination info
###

### Get tenants with filters and pagination
GET {{baseUrl}}/api/tenants?status=active&page=1&limit=3
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ max 3 active tenants v√† pagination info
###

### Get all tenants (TENANT - FORBIDDEN)
GET {{baseUrl}}/api/tenants
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
# Ch·ªâ OWNER m·ªõi c√≥ th·ªÉ xem danh s√°ch tenants
###

### Get all tenants (WITHOUT AUTH - FAIL)
GET {{baseUrl}}/api/tenants

###
# EXPECT: 401 Unauthorized
###

#######################################
### 1Ô∏è‚É£1Ô∏è‚É£ TEST REMOVE TENANT API
#######################################

### Remove tenant from room (SUCCESS - OWNER)
POST {{baseUrl}}/api/rooms/69981d9e46c8af57f060929c/remove-tenant
Authorization: Bearer {{owner_token}}

###
# EXPECT: 200 OK
# Response s·∫Ω c√≥ room data v·ªõi currentTenant = null v√† status = AVAILABLE
# Tenant record s·∫Ω ƒë∆∞·ª£c c·∫≠p nh·∫≠t status = INACTIVE v√† contractEndDate = ng√†y hi·ªán t·∫°i
###

### Remove tenant from room that has no tenant (ERROR)
POST {{baseUrl}}/api/rooms/69981d9e46c8af57f060929c/remove-tenant
Authorization: Bearer {{owner_token}}

###
# EXPECT: 400 Bad Request
# Response: {"message": "Room has no tenant to remove"}
###

### Remove tenant from non-existent room (ERROR)
POST {{baseUrl}}/api/rooms/507f1f77bcf86cd799439011/remove-tenant
Authorization: Bearer {{owner_token}}

###
# EXPECT: 404 Not Found
# Response: {"message": "Room not found or you don't own the building"}
###

### Remove tenant from room (TENANT - FORBIDDEN)
POST {{baseUrl}}/api/rooms/69981d9e46c8af57f060929c/remove-tenant
Authorization: Bearer {{tenant_token}}

###
# EXPECT: 403 Forbidden
# Response: {"message": "Tenants cannot remove tenants from rooms"}
###

### Remove tenant from room (WITHOUT AUTH - FAIL)
POST {{baseUrl}}/api/rooms/69981d9e46c8af57f060929c/remove-tenant

###
# EXPECT: 401 Unauthorized
###
